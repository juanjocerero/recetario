# Plan de Pruebas Funcionales: Implementación de Better Auth

Este documento detalla los casos de prueba para validar la correcta implementación del sistema de autenticación con Better Auth.

---

### Test Suite 1: Acceso Público y Protección de Rutas

**Objetivo:** Verificar que las rutas públicas son accesibles y las protegidas redirigen correctamente.

*   **Test Case 1.1: Acceso a rutas públicas sin autenticación.**
    *   **Precondiciones:** No hay ninguna sesión de usuario activa (navegador en modo incógnito o después de cerrar sesión).
    *   **Pasos:**
        1.  Navegar a la página de inicio (`/`).
        2.  Navegar a la página de búsqueda avanzada (`/recetas/busqueda-avanzada`).
        3.  Navegar a la página de login (`/login`).
        4.  Navegar a la página de registro (`/signup`).
    *   **Resultado Esperado:** Todas las páginas se cargan correctamente sin redirecciones.

*   **Test Case 1.2: Intento de acceso a ruta protegida sin autenticación.**
    *   **Precondiciones:** No hay ninguna sesión de usuario activa.
    *   **Pasos:**
        1.  Intentar navegar directamente a la ruta del diario (`/diario`).
    *   **Resultado Esperado:**
        1.  El sistema redirige automáticamente al usuario a la página de login (`/login`).
        2.  La URL final es `/login?redirectTo=/diario`.

*   **Test Case 1.3: Intento de acceso a ruta de administrador sin autenticación.**
    *   **Precondiciones:** No hay ninguna sesión de usuario activa.
    *   **Pasos:**
        1.  Intentar navegar directamente a la ruta de administración de productos (`/admin/products`).
    *   **Resultado Esperado:**
        1.  El sistema redirige al usuario a `/login`.
        2.  La URL final es `/login?redirectTo=/admin/products`.

---

### Test Suite 2: Registro de Usuario (Sign Up)

**Objetivo:** Validar el flujo de creación de nuevas cuentas.

*   **Test Case 2.1: Registro exitoso con datos válidos.**
    *   **Precondiciones:** No hay ninguna sesión de usuario activa.
    *   **Pasos:**
        1.  Navegar a la página de registro (`/signup`).
        2.  Rellenar el formulario con un nombre, un email **nuevo** (ej. `testuser@example.com`) y una contraseña válida (mínimo 8 caracteres).
        3.  Enviar el formulario.
    *   **Resultado Esperado:**
        1.  Se muestra una notificación de éxito.
        2.  El usuario es redirigido a la página de inicio (`/`).
        3.  El menú de navegación ahora muestra las opciones para un usuario autenticado (Diario, Cerrar Sesión).

*   **Test Case 2.2: Intento de registro con un email ya existente.**
    *   **Precondiciones:** No hay ninguna sesión de usuario activa.
    *   **Pasos:**
        1.  Navegar a `/signup`.
        2.  Rellenar el formulario usando el email de un usuario ya existente (ej. `ana.14mp@hotmail.com`).
        3.  Enviar el formulario.
    *   **Resultado Esperado:**
        1.  El formulario muestra un mensaje de error específico indicando que el email ya está en uso.
        2.  El usuario no es redirigido y permanece en la página de registro.

*   **Test Case 2.3: Intento de registro con contraseña inválida.**
    *   **Precondiciones:** No hay ninguna sesión de usuario activa.
    *   **Pasos:**
        1.  Navegar a `/signup`.
        2.  Rellenar el formulario con datos válidos pero una contraseña corta (ej. `123`).
        3.  Enviar el formulario.
    *   **Resultado Esperado:**
        1.  El formulario muestra un mensaje de error indicando que la contraseña no cumple los requisitos de longitud.
        2.  El usuario no es redirigido.

---

### Test Suite 3: Inicio de Sesión (Login)

**Objetivo:** Validar el flujo de autenticación de usuarios existentes.

*   **Test Case 3.1: Login fallido con credenciales incorrectas.**
    *   **Precondiciones:** No hay ninguna sesión de usuario activa.
    *   **Pasos:**
        1.  Navegar a `/login`.
        2.  Introducir un email válido (`ana.14mp@hotmail.com`) y una contraseña **incorrecta**.
        3.  Enviar el formulario.
    *   **Resultado Esperado:**
        1.  Se muestra un mensaje de error de "Credenciales inválidas".
        2.  El usuario permanece en la página de login.

*   **Test Case 3.2: Login exitoso de usuario estándar.**
    *   **Precondiciones:** No hay ninguna sesión de usuario activa.
    *   **Pasos:**
        1.  Navegar a `/login`.
        2.  Introducir las credenciales del usuario estándar:
            *   Email: `ana.14mp@hotmail.com`
            *   Contraseña: `user1234`
        3.  Enviar el formulario.
    *   **Resultado Esperado:**
        1.  Se muestra una notificación de bienvenida.
        2.  El usuario es redirigido a la página de inicio (`/`).
        3.  El menú de navegación **no** muestra el botón de "Administrar productos".

*   **Test Case 3.3: Login exitoso de usuario administrador.**
    *   **Precondiciones:** No hay ninguna sesión de usuario activa.
    *   **Pasos:**
        1.  Navegar a `/login`.
        2.  Introducir las credenciales del administrador:
            *   Email: `juanjocerero@gmail.com`
            *   Contraseña: `admin1234`
        3.  Enviar el formulario.
    *   **Resultado Esperado:**
        1.  Se muestra una notificación de bienvenida.
        2.  El usuario es redirigido a la página de inicio (`/`).
        3.  El menú de navegación **sí** muestra el botón de "Administrar productos".

*   **Test Case 3.4: Login exitoso con redirección a ruta previa.**
    *   **Precondiciones:** No hay ninguna sesión de usuario activa.
    *   **Pasos:**
        1.  Navegar directamente a `/diario`. El sistema redirige a `/login?redirectTo=/diario`.
        2.  Iniciar sesión con cualquier usuario válido.
    *   **Resultado Esperado:**
        1.  Tras el login exitoso, el usuario es redirigido a `/diario`, no a la página de inicio.

---

### Test Suite 4: Cierre de Sesión (Logout)

**Objetivo:** Validar que la sesión del usuario se termina correctamente.

*   **Test Case 4.1: Cierre de sesión exitoso.**
    *   **Precondiciones:** Un usuario está autenticado.
    *   **Pasos:**
        1.  Abrir el menú de navegación.
        2.  Hacer clic en el botón "Cerrar Sesión".
    *   **Resultado Esperado:**
        1.  Se muestra una notificación de "Sesión cerrada".
        2.  El menú de navegación se actualiza para mostrar el botón de "Iniciar Sesión".
        3.  Si se intenta acceder a una ruta protegida (ej. `/diario`), se redirige al login.
